<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mandy Ei | Premium Real Estate Singapore</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            important: '#property-root', 
            theme: {
                extend: {
                    colors: {
                        primary: '#0B1120',     /* Deep Navy */
                        gold: '#C5A059',        /* Muted Luxury Gold */
                        'gold-light': '#E5C585',
                        surface: '#F8F9FA',
                    },
                    fontFamily: {
                        sans: ['Lato', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* --- SCOPED RESET --- */
        #property-root {
            all: initial; 
            font-family: 'Lato', sans-serif;
            color: #334155;
            line-height: 1.6;
            background-color: #F8F9FA;
            width: 100%;
            display: block;
            box-sizing: border-box;
        }
        #property-root * { box-sizing: border-box; }
        
        /* Typography */
        #property-root h1, #property-root h2, #property-root h3, #property-root h4 {
            font-family: 'Playfair Display', serif;
            margin: 0; line-height: 1.2; color: #0B1120;
        }
        #property-root a { text-decoration: none; color: inherit; cursor: pointer; transition: 0.3s; }
        #property-root button { cursor: pointer; transition: 0.3s; }

        /* --- COMPONENTS --- */
        #property-root .custom-container {
            max-width: 1400px; margin: 0 auto; padding: 0 20px;
        }

        /* Search Input */
        #property-root .search-input {
            width: 100%;
            padding: 14px 14px 14px 45px;
            border: 1px solid #E2E8F0;
            border-radius: 8px;
            font-size: 0.95rem;
            outline: none;
            transition: 0.3s;
            background: #fff;
        }
        #property-root .search-input:focus {
            border-color: #C5A059;
            box-shadow: 0 0 0 3px rgba(197, 160, 89, 0.1);
        }

        /* Sidebar Filters */
        #property-root .filter-btn {
            display: flex; justify-content: space-between; align-items: center;
            width: 100%; text-align: left; padding: 14px 18px; margin-bottom: 8px;
            background: #fff; border: 1px solid #E2E8F0;
            border-radius: 8px; color: #64748b; font-weight: 600; font-size: 0.9rem;
        }
        #property-root .filter-btn:hover { border-color: #C5A059; color: #C5A059; background: #FFFCF5; }
        #property-root .filter-btn.active { background: #0B1120; color: #fff; border-color: #0B1120; box-shadow: 0 4px 12px rgba(11, 17, 32, 0.2); }
        #property-root .filter-btn.active i { color: #C5A059; }

        /* Card Gallery Arrows */
        #property-root .nav-arrow {
            position: absolute; top: 50%; transform: translateY(-50%);
            background: rgba(255,255,255,0.9); color: #0B1120;
            width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: none; cursor: pointer; z-index: 20;
            opacity: 0; transition: all 0.2s; box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        #property-root .nav-arrow:hover { background: #C5A059; color: white; transform: translateY(-50%) scale(1.1); }
        #property-root .img-wrapper:hover .nav-arrow { opacity: 1; }
        #property-root .nav-arrow.left { left: 12px; }
        #property-root .nav-arrow.right { right: 12px; }

        /* Modal Gallery Arrows */
        #property-root .modal-arrow {
            position: absolute; top: 50%; transform: translateY(-50%);
            background: rgba(0,0,0,0.4); color: white;
            width: 45px; height: 45px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 1px solid rgba(255,255,255,0.2); cursor: pointer; z-index: 50;
            transition: all 0.2s; backdrop-filter: blur(4px);
        }
        #property-root .modal-arrow:hover { background: #C5A059; border-color: #C5A059; }
        #property-root .modal-arrow.left { left: 20px; }
        #property-root .modal-arrow.right { right: 20px; }

        /* Translator Floating Button */
        #property-root .translator-float {
            position: fixed; bottom: 30px; right: 30px;
            background: #0B1120; color: #fff;
            padding: 12px 20px; border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
            z-index: 9999; cursor: pointer;
            font-weight: 700; font-size: 0.9rem;
            display: flex; align-items: center; gap: 10px;
            border: 2px solid #C5A059;
            transition: transform 0.2s;
        }
        #property-root .translator-float:hover { transform: scale(1.05); }

        /* Modal Structure */
        #property-root .modal-overlay {
            display: none; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; background: rgba(11, 17, 32, 0.9);
            z-index: 5000; padding: 20px; align-items: center; justify-content: center;
            backdrop-filter: blur(5px);
        }
        #property-root .modal-overlay.open { display: flex; }

        /* Mobile Adjustments */
        #mobile-filter-toggle { display: none; }
        
        @media (max-width: 1024px) {
            #property-root .catalog-grid { grid-template-columns: 1fr !important; gap: 30px !important; }
            
            /* Sidebar hidden/collapsible on mobile */
            #property-root .sidebar { display: none; width: 100%; }
            #property-root .sidebar.active { display: block; position: static; animation: fadeIn 0.3s ease; }
            #mobile-filter-toggle { display: flex !important; }
            
            /* Modal Mobile */
            #property-root .modal-content-box { 
                grid-template-columns: 1fr !important; 
                height: 100% !important; 
                width: 100% !important; 
                max-width: 100% !important;
                border-radius: 0 !important;
            }
            #property-root #modalImg { max-height: 50vh; object-fit: cover !important; }
            #property-root .modal-details { padding: 30px 20px !important; }
            #property-root #closeModal { top: 15px !important; right: 15px !important; background: rgba(255,255,255,0.9) !important; }
            
            /* Header */
            #property-root h1#heroTitle { font-size: 2.2rem !important; }
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="property-root">

    <header style="background: #fff; height: 80px; border-bottom: 1px solid #E2E8F0; position: sticky; top: 0; z-index: 1000;">
        <div class="custom-container" style="height: 100%; display: flex; justify-content: space-between; align-items: center;">
            <div style="font-size: 1.5rem; font-weight: 700; color: #0B1120; display: flex; align-items: center; gap: 10px;">
                <div style="width: 35px; height: 35px; background: #0B1120; color: #C5A059; display: flex; align-items: center; justify-content: center; border-radius: 4px;">
                    <i class="fas fa-building"></i>
                </div>
                <span style="font-family: 'Playfair Display', serif;">Mandy Ei</span>
            </div>
            <nav class="hidden md:flex" style="gap: 25px; font-weight: 600; font-size: 0.9rem; text-transform: uppercase;">
                <a class="hover:text-gold" id="navHome" style="color: #0B1120;">Properties</a>
                <a class="hover:text-gold" id="navAbout" style="color: #94a3b8;">About</a>
                <a class="hover:text-gold" id="navContact" style="color: #C5A059;">Contact</a>
            </nav>
            <div class="md:hidden" style="font-size: 1.2rem; color: #0B1120;">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>

    <section style="position: relative; height: 400px; display: flex; align-items: center; justify-content: center; text-align: center; background: #000;">
        <div style="position: absolute; top:0; left:0; width:100%; height:100%; opacity: 0.6; background: url('https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80') center/cover;"></div>
        
        <div class="custom-container" style="position: relative; z-index: 2;">
            <h1 id="heroTitle" style="font-size: 3rem; color: #fff; margin-bottom: 15px; text-shadow: 0 2px 10px rgba(0,0,0,0.5);">
                Curating Singapore's Finest Spaces
            </h1>
            <p id="heroSubtitle" style="color: #cbd5e1; font-size: 1.1rem; max-width: 600px; margin: 0 auto;">
                Exclusive commercial offices, heritage shophouses, and luxury residences.
            </p>
        </div>
    </section>

    <section class="custom-container catalog-grid" style="display: grid; grid-template-columns: 260px 1fr; gap: 40px; margin-top: 50px; margin-bottom: 100px;">
        
        <button id="mobile-filter-toggle" onclick="toggleMobileSidebar()" style="width: 100%; padding: 15px; background: #0B1120; color: white; border-radius: 8px; justify-content: center; align-items: center; gap: 10px; font-weight: 600; margin-bottom: 10px;">
            <i class="fas fa-sliders-h"></i> <span id="btnFilterToggle">Search & Filter Properties</span>
        </button>

        <aside class="sidebar" id="sidebarElement" style="height: fit-content; position: sticky; top: 100px;">
            <div style="position: relative; margin-bottom: 25px;">
                <i class="fas fa-search" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #94a3b8; z-index: 2;"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="Search title or location...">
            </div>

            <div style="margin-bottom: 30px;">
                <h3 id="filterTitle" style="font-size: 1.1rem; margin-bottom: 15px; color: #0B1120; border-bottom: 2px solid #C5A059; padding-bottom: 5px; display: inline-block;">Collection</h3>
                
                <button class="filter-btn active" data-filter="all" id="btnAll">
                    <span>All Listings</span> <i class="fas fa-layer-group"></i>
                </button>
                <button class="filter-btn" data-filter="Commercial" id="btnComm">
                    <span>Commercial Office</span> <i class="fas fa-briefcase"></i>
                </button>
                <button class="filter-btn" data-filter="Retail" id="btnRetail">
                    <span>Shophouse & Retail</span> <i class="fas fa-store"></i>
                </button>
                <button class="filter-btn" data-filter="Condo" id="btnCondo">
                    <span>Luxury Residence</span> <i class="fas fa-home"></i>
                </button>
                <button class="filter-btn" data-filter="Industrial" id="btnInd">
                    <span>Industrial B1/B2</span> <i class="fas fa-industry"></i>
                </button>
            </div>

            <div class="hidden md:block" style="background: white; border: 1px solid #E2E8F0; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.03);">
                <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?auto=format&fit=crop&q=80&w=200&h=200" style="width: 70px; height: 70px; border-radius: 50%; margin: 0 auto 10px; object-fit: cover; border: 2px solid #C5A059;">
                <h4 style="font-size: 1rem; font-weight: 700;">Mandy Ei</h4>
                <p style="font-size: 0.8rem; color: #64748b; margin-bottom: 12px;">Senior Wealth Director</p>
                <a href="https://wa.me/6598765432" target="_blank" style="display: block; padding: 10px; background: #25D366; color: white; border-radius: 6px; font-weight: 700; font-size: 0.85rem;">
                    <i class="fab fa-whatsapp"></i> WhatsApp Me
                </a>
            </div>
        </aside>

        <div>
            <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 1px solid #E2E8F0; padding-bottom: 15px;">
                <div>
                    <h2 id="listingsHeader" style="font-size: 1.8rem; color: #0B1120;">Signature Listings</h2>
                    <p style="color: #64748b; font-size: 0.9rem; margin-top: 5px;">Showing <span id="countDisplay" style="color: #0B1120; font-weight: 700;">0</span> properties</p>
                </div>
            </div>

            <div id="propertyGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px;">
                </div>
            
            <div id="noResults" style="display: none; text-align: center; padding: 50px; color: #94a3b8;">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 10px;"></i>
                <p>No properties found matching your search.</p>
            </div>
        </div>
    </section>

    <div class="modal-overlay" id="detailModal">
        <div class="modal-content-box" style="background: #fff; width: 95%; max-width: 1100px; height: 85vh; border-radius: 16px; display: grid; grid-template-columns: 1.5fr 1fr; overflow: hidden; position: relative; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);">
            
            <button id="closeModal" style="position: absolute; top: 20px; right: 20px; background: white; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 1.5rem; color: #0B1120; cursor: pointer; z-index: 100; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center;">×</button>
            
            <div style="background: #000; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                <img id="modalImg" src="" style="width: 100%; height: 100%; object-fit: contain; transition: opacity 0.3s;">
                <button class="modal-arrow left" onclick="prevModalImg()"><i class="fas fa-chevron-left"></i></button>
                <button class="modal-arrow right" onclick="nextModalImg()"><i class="fas fa-chevron-right"></i></button>
                <div style="position: absolute; bottom: 20px; left: 0; width: 100%; text-align: center; color: rgba(255,255,255,0.7); font-size: 0.9rem;">
                    <i class="fas fa-camera"></i> <span id="modalImgCounter">1 / 5</span>
                </div>
            </div>

            <div class="modal-details" style="padding: 40px; display: flex; flex-direction: column; overflow-y: auto; background: white;">
                <div id="modalCat" style="color: #C5A059; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; font-size: 0.75rem; margin-bottom: 10px;">CATEGORY</div>
                
                <h2 id="modalTitle" style="font-size: 1.8rem; margin-bottom: 10px; color: #0B1120; line-height: 1.2;">Property Title</h2>
                
                <div style="display: flex; gap: 20px; color: #64748b; font-size: 0.9rem; margin-bottom: 25px; border-bottom: 1px solid #f1f5f9; padding-bottom: 15px;">
                    <span><i class="fas fa-map-marker-alt text-gold"></i> <span id="modalLoc">Location</span></span>
                    <span><i class="fas fa-vector-square text-gold"></i> <span id="modalSize">2,000 sqft</span></span>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div id="modalPrice" style="font-size: 1.8rem; color: #0B1120; font-weight: 700; font-family: 'Lato', sans-serif;">$5,000,000</div>
                    <div id="modalPsf" style="color: #94a3b8; font-size: 0.95rem;">$2,500 psf</div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h4 style="font-size: 1rem; margin-bottom: 10px; font-weight: 600;">Property Highlights</h4>
                    <p id="modalDesc" style="color: #475569; line-height: 1.7; font-size: 0.95rem;">Description goes here...</p>
                </div>

                <div style="margin-top: auto; display: grid; gap: 12px;">
                    <a id="btnMap" href="#" target="_blank" style="text-align: center; padding: 15px; background: #F8FAFC; border: 1px solid #E2E8F0; color: #0B1120; border-radius: 8px; font-weight: 700; transition: 0.2s;">
                        <i class="fas fa-map-marked-alt text-gold"></i> <span id="textMap">View Location on Map</span>
                    </a>
                    <a id="btnWhatsapp" href="#" target="_blank" style="text-align: center; padding: 15px; background: #0B1120; color: #fff; border-radius: 8px; font-weight: 700; border: 2px solid #0B1120; transition: 0.2s;">
                        <i class="fab fa-whatsapp"></i> <span id="textAgent">Enquire via WhatsApp</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="translator-float" onclick="toggleLanguage()">
        <i class="fas fa-globe"></i> <span id="langLabel">EN / CN</span>
    </div>

</div>

<script>
    /* --- 1. DATA SETUP --- */
    const imgPool = {
        house: [
            "https://img.iproperty.com.my/angel-legacy/1110x624-crop/static/2020/08/landed-property-singapore-terrace-house.jpg",
            "https://cassette.sphdigital.com.sg/image/homedecor/533e2bd789056e5d64b100cb9fea47150be56e38876d265f41c32299265df21f?w=1000&q=85",
            "https://images.unsplash.com/photo-1600596542815-2495db98dada?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?auto=format&fit=crop&q=80&w=800"
        ],
        office: [
            "https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1497215728101-856f4ea42174?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1577412647305-991150c7d163?auto=format&fit=crop&q=80&w=800"
        ],
        retail: [
            "https://images.unsplash.com/photo-1555529733-0e670560f7e1?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1519643381401-22c77e60520e?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1534452203293-494d7ddbf7e0?auto=format&fit=crop&q=80&w=800"
        ],
        condo: [
            "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?auto=format&fit=crop&q=80&w=800",
            "https://images.unsplash.com/photo-1574362848149-11496d93a7c7?auto=format&fit=crop&q=80&w=800"
        ]
    };

    const locations = ["Raffles Place", "Marina Bay", "Tanjong Pagar", "Orchard Road", "Amoy Street", "Jurong East", "Paya Lebar", "River Valley", "Bukit Timah", "Keong Saik"];
    const types = ["Commercial", "Commercial", "Commercial", "Commercial", "Retail", "Retail", "Retail", "Condo", "Condo", "Industrial"]; 

    const dictionary = {
        en: {
            navHome: "Properties", navNew: "New Launches", navAbout: "About", navContact: "Contact",
            heroTitle: "Curating Singapore's Finest Spaces",
            heroSubtitle: "Exclusive commercial offices, heritage shophouses, and luxury residences.",
            filterTitle: "Collection",
            btnFilterToggle: "Search & Filter Properties",
            btnAll: "All Listings", btnComm: "Commercial Office", btnRetail: "Shophouse & Retail", btnCondo: "Luxury Residence", btnInd: "Industrial B1/B2",
            listingsHeader: "Signature Listings", 
            textMap: "View Location on Map", textAgent: "Enquire via WhatsApp",
            catComm: "Prime Commercial", catRetail: "Heritage Retail", catCondo: "Luxury Residence", catInd: "Industrial Asset",
            searchPlaceholder: "Search title or location..."
        },
        cn: {
            navHome: "房产列表", navNew: "新楼盘", navAbout: "关于", navContact: "联系我们",
            heroTitle: "甄选新加坡顶级空间",
            heroSubtitle: "独家商业办公室、传统店屋和豪华住宅。",
            filterTitle: "房产系列",
            btnFilterToggle: "搜索与筛选房源",
            btnAll: "全部房源", btnComm: "商业办公室", btnRetail: "店屋与零售", btnCondo: "豪华住宅", btnInd: "工业 B1/B2",
            listingsHeader: "精选房源", 
            textMap: "在地图上查看位置", textAgent: "通过 WhatsApp 咨询",
            catComm: "优质商业空间", catRetail: "传统店屋/零售", catCondo: "豪华住宅", catInd: "工业资产",
            searchPlaceholder: "搜索标题或地点..."
        }
    };

    let currentLang = 'en';
    let properties = [];
    let currentModalId = null;

    function initData() {
        for (let i = 0; i < 40; i++) {
            const type = types[Math.floor(Math.random() * types.length)];
            const loc = locations[Math.floor(Math.random() * locations.length)];
            const size = (Math.floor(Math.random() * 60) + 10) * 100; 
            
            let psf = type === 'Retail' ? 4500 : (type === 'Condo' ? 2200 : 2800);
            if(type === 'Industrial') psf = 600;
            const price = size * psf;
            
            let poolKey = type === 'Condo' ? 'condo' : (type === 'Retail' ? 'retail' : 'office');
            if(i < 2) poolKey = 'house'; 

            const gallery = [];
            const count = 3 + Math.floor(Math.random() * 2);
            for(let j=0; j<count; j++) gallery.push(imgPool[poolKey][Math.floor(Math.random() * imgPool[poolKey].length)]);

            properties.push({
                id: i,
                type: type,
                location: loc,
                location_cn: loc + " (新加坡)",
                size: size,
                price: price,
                psf: psf,
                title_en: `${type === 'Retail' ? 'Rare' : 'Premium'} ${type} at ${loc}`,
                title_cn: `位于 ${loc} 的${type === 'Retail' ? '稀有' : '优质'}${type === 'Condo' ? '公寓' : (type === 'Retail' ? '店屋' : '办公空间')}`,
                desc_en: `An exceptional opportunity to acquire a prime ${type.toLowerCase()} unit in the heart of ${loc}. Boasting high ceilings, excellent natural light, and proximity to major transport hubs. Ideal for ${type === 'Condo' ? 'family living' : 'business expansion'} or investment.`,
                desc_cn: `在 ${loc} 核心地带置业的绝佳机会。拥有高天花板、极佳的自然采光，紧邻主要交通枢纽。非常适合${type === 'Condo' ? '家庭居住' : '业务扩展'}或投资。`,
                images: gallery,
                cardImgIndex: 0,
                modalImgIndex: 0
            });
        }
    }

    /* --- 2. RENDER FUNCTIONS --- */
    function formatMoney(amount) {
        if(amount > 1000000) return '$' + (amount/1000000).toFixed(2) + 'M';
        return '$' + amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function renderGrid() {
        const grid = document.getElementById('propertyGrid');
        const noResults = document.getElementById('noResults');
        const activeFilter = document.querySelector('.filter-btn.active').getAttribute('data-filter');
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        
        grid.innerHTML = '';
        
        const filtered = properties.filter(p => {
            const matchType = activeFilter === 'all' || p.type === activeFilter;
            const matchSearch = (currentLang === 'en' ? p.title_en : p.title_cn).toLowerCase().includes(searchTerm) ||
                                (currentLang === 'en' ? p.location : p.location_cn).toLowerCase().includes(searchTerm);
            return matchType && matchSearch;
        });

        document.getElementById('countDisplay').innerText = filtered.length;

        if (filtered.length === 0) {
            noResults.style.display = 'block';
        } else {
            noResults.style.display = 'none';
        }

        filtered.forEach(p => {
            const title = currentLang === 'en' ? p.title_en : p.title_cn;
            const loc = currentLang === 'en' ? p.location : p.location_cn;
            const dict = dictionary[currentLang];
            const typeLabel = dict[`cat${p.type === 'Commercial' ? 'Comm' : (p.type === 'Condo' ? 'Condo' : (p.type === 'Retail' ? 'Retail' : 'Ind'))}`];

            const card = document.createElement('div');
            card.style.cssText = "background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: transform 0.3s; border: 1px solid #F1F5F9; display: flex; flex-direction: column;";
            
            // Image Wrapper now has onclick
            card.innerHTML = `
                <div class="img-wrapper" onclick="openModal(${p.id})" style="position: relative; height: 240px; overflow: hidden; background: #000; cursor: pointer;">
                    <img src="${p.images[p.cardImgIndex]}" id="card-img-${p.id}" style="width: 100%; height: 100%; object-fit: cover; transition: opacity 0.3s;">
                    
                    <button class="nav-arrow left" onclick="prevCardImg(event, ${p.id})"><i class="fas fa-chevron-left"></i></button>
                    <button class="nav-arrow right" onclick="nextCardImg(event, ${p.id})"><i class="fas fa-chevron-right"></i></button>
                    
                    <div style="position: absolute; top: 15px; left: 15px; background: rgba(11, 17, 32, 0.9); color: #C5A059; padding: 5px 10px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; border-radius: 4px; letter-spacing: 1px;">
                        ${typeLabel}
                    </div>
                </div>
                
                <div style="padding: 25px; display: flex; flex-direction: column; flex-grow: 1; cursor: pointer;" onclick="openModal(${p.id})">
                    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 8px; color: #0B1120; line-height: 1.3;">${title}</h3>
                    <div style="color: #64748b; font-size: 0.9rem; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-map-pin" style="color: #C5A059;"></i> ${loc}
                    </div>
                    
                    <div style="margin-top: auto; padding-top: 15px; border-top: 1px solid #F1F5F9; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <span style="display: block; font-weight: 700; color: #0B1120; font-size: 1.2rem;">${formatMoney(p.price)}</span>
                            <span style="font-size: 0.8rem; color: #94a3b8;">$${p.psf} psf</span>
                        </div>
                        <span style="font-size: 0.9rem; color: #64748b; font-weight: 500;">
                            <i class="fas fa-ruler-combined"></i> ${p.size.toLocaleString()} sqft
                        </span>
                    </div>
                </div>
            `;
            grid.appendChild(card);
        });
    }

    /* --- 3. GALLERY LOGIC --- */
    window.prevCardImg = function(e, id) {
        e.stopPropagation(); // Prevents modal from opening
        const p = properties.find(x => x.id === id);
        p.cardImgIndex = (p.cardImgIndex - 1 + p.images.length) % p.images.length;
        document.getElementById(`card-img-${id}`).src = p.images[p.cardImgIndex];
    }
    window.nextCardImg = function(e, id) {
        e.stopPropagation();
        const p = properties.find(x => x.id === id);
        p.cardImgIndex = (p.cardImgIndex + 1) % p.images.length;
        document.getElementById(`card-img-${id}`).src = p.images[p.cardImgIndex];
    }

    window.updateModalImage = function() {
        const p = properties.find(x => x.id === currentModalId);
        const imgEl = document.getElementById('modalImg');
        const countEl = document.getElementById('modalImgCounter');
        imgEl.style.opacity = '0.5';
        setTimeout(() => {
            imgEl.src = p.images[p.modalImgIndex];
            imgEl.style.opacity = '1';
        }, 150);
        countEl.innerText = `${p.modalImgIndex + 1} / ${p.images.length}`;
    }

    window.prevModalImg = function() {
        if(currentModalId === null) return;
        const p = properties.find(x => x.id === currentModalId);
        p.modalImgIndex = (p.modalImgIndex - 1 + p.images.length) % p.images.length;
        updateModalImage();
    }

    window.nextModalImg = function() {
        if(currentModalId === null) return;
        const p = properties.find(x => x.id === currentModalId);
        p.modalImgIndex = (p.modalImgIndex + 1) % p.images.length;
        updateModalImage();
    }

    /* --- 4. MODAL & UI --- */
    const modal = document.getElementById('detailModal');

    window.openModal = function(id) {
        currentModalId = id;
        const p = properties.find(x => x.id === id);
        const dict = dictionary[currentLang];

        p.modalImgIndex = 0;
        updateModalImage();

        document.getElementById('modalTitle').innerText = currentLang === 'en' ? p.title_en : p.title_cn;
        document.getElementById('modalCat').innerText = dict[`cat${p.type === 'Commercial' ? 'Comm' : (p.type === 'Condo' ? 'Condo' : (p.type === 'Retail' ? 'Retail' : 'Ind'))}`];
        document.getElementById('modalLoc').innerText = currentLang === 'en' ? p.location : p.location_cn;
        document.getElementById('modalPrice').innerText = formatMoney(p.price);
        document.getElementById('modalSize').innerText = `${p.size.toLocaleString()} sqft`;
        document.getElementById('modalPsf').innerText = `$${p.psf.toLocaleString()} psf`;
        document.getElementById('modalDesc').innerText = currentLang === 'en' ? p.desc_en : p.desc_cn;

        document.getElementById('btnMap').href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(p.location + " Singapore")}`;
        const msg = encodeURIComponent(`Hi Mandy, I am interested in ${p.title_en} (${formatMoney(p.price)}).`);
        document.getElementById('btnWhatsapp').href = `https://wa.me/6598765432?text=${msg}`;

        modal.classList.add('open');
        document.body.style.overflow = 'hidden';
    }

    document.getElementById('closeModal').onclick = () => {
        modal.classList.remove('open');
        document.body.style.overflow = 'auto';
        currentModalId = null;
    };
    
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.classList.remove('open');
            document.body.style.overflow = 'auto';
            currentModalId = null;
        }
    });

    // Mobile Sidebar Toggle
    window.toggleMobileSidebar = function() {
        const sidebar = document.getElementById('sidebarElement');
        sidebar.classList.toggle('active');
    }

    // Filter Logic
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.onclick = function() {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            renderGrid();
        }
    });

    // Search Logic
    document.getElementById('searchInput').addEventListener('input', renderGrid);

    window.toggleLanguage = function() {
        currentLang = currentLang === 'en' ? 'cn' : 'en';
        
        const dict = dictionary[currentLang];
        for (const [key, value] of Object.entries(dict)) {
            const el = document.getElementById(key);
            if (el) {
                if(el.children.length > 0) {
                     const span = el.querySelector('span');
                     if(span) span.innerText = value;
                } else {
                    el.innerText = value;
                }
            }
        }
        document.getElementById('searchInput').placeholder = dict.searchPlaceholder;
        
        renderGrid();
        if(currentModalId !== null) openModal(currentModalId);
    }

    // Init
    initData();
    renderGrid();

</script>
</body>
</html>
